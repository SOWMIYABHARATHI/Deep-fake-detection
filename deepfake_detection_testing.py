# -*- coding: utf-8 -*-
"""DeepFake Detection Testing

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1VaANrYWmSMGo9UG8S5UUKnUT9Mg7B7A8
"""

# IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES
# TO THE CORRECT LOCATION (/kaggle/input) IN YOUR NOTEBOOK,
# THEN FEEL FREE TO DELETE THIS CELL.
# NOTE: THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE'S PYTHON
# ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR
# NOTEBOOK.

import os
import sys
from tempfile import NamedTemporaryFile
from urllib.request import urlopen
from urllib.parse import unquote, urlparse
from urllib.error import HTTPError
from zipfile import ZipFile
import tarfile
import shutil

CHUNK_SIZE = 40960
DATA_SOURCE_MAPPING = '140k-real-and-fake-faces:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F501529%2F939937%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240505%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240505T031001Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D662d2e4f66528d0dbb698e0a64ee0f96324010f90e978e569b72ef0f1f8f5b3267cdeb57c8db9f65e7b763955efccce1e18f45ca867fa7dff9c6d03034504b708f1403ce1d4de468ff73de255bf5be9a5b7c91e28123ec25ad766c2e95d73d5ce0f42df7683032935bf1184acdc4791f0a621776fb3f81e72be8263f10f3196f436fd2a6a730dbc1df72bd790891d1310fd42c5bece61fc68f836db080c0dfeadc9cce7151b768f09083105491aaf54c17dbc5ff0084d3a8d8f20fd92033aadd4c7c130f0c1ab8f2231e4e52a818268462c044fd5e7e2582e280555597cd2b8dcc34b83d6672684fe005c46625227efe2a18fb179186b104de8366e0746fe1f2,vgg16deepfake-detection:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F2137546%2F3555852%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240505%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240505T031001Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D1c758bb7448c3a2add9d077dddbc122a0b0901a9b2c38b0913e4a3e164ffd09eb137cf349c5a9fe9b0f675cce73a2c3146e93e4eaa37365fc79d5c817abfc7436d5ce6c6e7508661e424fa699028aa03a403c4836fd6815aa46df15b9dd6ffdc6607fa7738c0d08f8dccec24d46329038759742a6142280fff42b4f2adca53c5d87f87a2b6f1629ec690f5707b3126d446113f01d16500115edf21031e72d6b8431a4cabdb01301f7daee2186bba443d2e6a4c0dd741010339007f9802c5042885239a5a38ef870c28f10eac257ec62160a2dc97c01ddbec730c5b1e56f2d367d4fa37ee7e24bc14280c86db5f96c22dbc240393a17b2ab11b88389d44d5abb0,custom-cnndeepfake-detection:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F2137550%2F3555856%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240505%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240505T031001Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D07b2400b48f6f3dc03cacfa6672011dac5952ae00770c3fa4e0b67a89d2a15e75afad2801fefce388d6767e5eb44283df276f2ec4e85499aa9da846f9bd5123d2f9f492151163cac6edeaa02ed64147b076e0769ebfa5d16cc020c0db5326e586eb91365672cee1af271759c0f39082d23f5481dcc07feb4ba4dc9c3cf9bdff547c578c096da6136992820372e4efb4ea2baf5205235e0a7526a44ba6b6bf911e8217e4d95780c401d10e15a706e6be4bef4355709bbb3e81c5af0b7cf0b3b613ef3506701201595fbaadfcb6e089c262844316b0ff31eaeca048ee4eaf68b6cab42d229e1d0022122240b84b0438a359bfdcd3d9b906c3600c7e99aedff620f,densenet121deepfake-detection:https%3A%2F%2Fstorage.googleapis.com%2Fkaggle-data-sets%2F2137551%2F3555857%2Fbundle%2Farchive.zip%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com%252F20240505%252Fauto%252Fstorage%252Fgoog4_request%26X-Goog-Date%3D20240505T031001Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D702311fbc300762793f724737aaac46511b28370b3633fb1e84854777f07519dc3331a0368956516a4f19555a8c9a3b54d32ef7c97a840bfd96906c2754e3bcda3cf3963b61318495f12315faaa189f4791d3af4511242b59f01973257a3d1a2a69573956164bb7b0d5ab8761f312cca67857fefaba8f331067678e7eff3323ff9cac33f5d5c6b092540b0b3a496612636ccd2ab357059e3e29c093a7e64edf0a7dc6a14fa0e9a5a4aa37de680bb03e332efa7bd2a35a4a428ac9030fa27f4e88846c223570117f1244857e4b470b8e24ebcfa951d3017b61a17734def9b9b8f712d9572f2ce3c47fe13ac1fdd7e23c7a6ae9166144232d7d4105c69038d2eff'

KAGGLE_INPUT_PATH='/kaggle/input'
KAGGLE_WORKING_PATH='/kaggle/working'
KAGGLE_SYMLINK='kaggle'

!umount /kaggle/input/ 2> /dev/null
shutil.rmtree('/kaggle/input', ignore_errors=True)
os.makedirs(KAGGLE_INPUT_PATH, 0o777, exist_ok=True)
os.makedirs(KAGGLE_WORKING_PATH, 0o777, exist_ok=True)

try:
  os.symlink(KAGGLE_INPUT_PATH, os.path.join("..", 'input'), target_is_directory=True)
except FileExistsError:
  pass
try:
  os.symlink(KAGGLE_WORKING_PATH, os.path.join("..", 'working'), target_is_directory=True)
except FileExistsError:
  pass

for data_source_mapping in DATA_SOURCE_MAPPING.split(','):
    directory, download_url_encoded = data_source_mapping.split(':')
    download_url = unquote(download_url_encoded)
    filename = urlparse(download_url).path
    destination_path = os.path.join(KAGGLE_INPUT_PATH, directory)
    try:
        with urlopen(download_url) as fileres, NamedTemporaryFile() as tfile:
            total_length = fileres.headers['content-length']
            print(f'Downloading {directory}, {total_length} bytes compressed')
            dl = 0
            data = fileres.read(CHUNK_SIZE)
            while len(data) > 0:
                dl += len(data)
                tfile.write(data)
                done = int(50 * dl / int(total_length))
                sys.stdout.write(f"\r[{'=' * done}{' ' * (50-done)}] {dl} bytes downloaded")
                sys.stdout.flush()
                data = fileres.read(CHUNK_SIZE)
            if filename.endswith('.zip'):
              with ZipFile(tfile) as zfile:
                zfile.extractall(destination_path)
            else:
              with tarfile.open(tfile.name) as tarfile:
                tarfile.extractall(destination_path)
            print(f'\nDownloaded and uncompressed: {directory}')
    except HTTPError as e:
        print(f'Failed to load (likely expired) {download_url} to path {destination_path}')
        continue
    except OSError as e:
        print(f'Failed to load {download_url} to path {destination_path}')
        continue

print('Data source import complete.')

from PIL import Image as imagepil
from keras import models
from tensorflow.keras.preprocessing.image import ImageDataGenerator
import numpy as np
from keras.preprocessing import image
import urllib
from IPython.display import Image

"""INSTALL ngrok"""

#url='data:image/jpeg;base64,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'
filename='../input/140k-real-and-fake-faces/real_vs_fake/real-vs-fake/test/real/00016.jpg'
# urllib.request.urlretrieve(url,filename)
img = imagepil.open(filename)
img = img.resize((224, 224))
tmp = image.load_img(filename,target_size=(224,224))
tmp=np.expand_dims(tmp,axis=0)

vgg_model='../input/vgg16deepfake-detection/vggface.h5'
densenet_model='../input/densenet121deepfake-detection/densenet121.h5'
custom_cnn='../input/custom-cnndeepfake-detection/customcnn.h5'

Image(filename=filename, width= 224, height=224)

"""**VGG16 testing**"""

model=models.load_model(vgg_model)
preds=model.predict(tmp)
preds=np.argmax(preds,axis=1)
print("Realness:"+str(preds>0.5))

"""**DenseNet121 Testing**"""

model=models.load_model(densenet_model)
preds=model.predict(tmp)
print("Realness:"+str(preds>0.5))

"""**CustomCNN Testing**"""

model=models.load_model(custom_cnn)
preds=model.predict(tmp)
print("Realness:"+str(preds>0.5))

"""TESTING MULTIPLE INSTANCES"""

vgg_model='../input/vgg16deepfake-detection/vggface.h5'
densenet_model='../input/densenet121deepfake-detection/densenet121.h5'
custom_cnn='../input/custom-cnndeepfake-detection/customcnn.h5'

def vgg_test(tmp):
  print("\nVGG TEST:")
  model=models.load_model(vgg_model)
  preds=model.predict(tmp)
  preds=np.argmax(preds,axis=1)
  print("Realness:"+str(preds>0.5))

def densenet_test(tmp):
  print("\nDENSENET TEST:")
  model=models.load_model(densenet_model)
  preds=model.predict(tmp)
  print("Realness:"+str(preds>0.5))

def custom_cnn_test(tmp):
  print("\nCUSTOM CNN TEST:")
  model=models.load_model(custom_cnn)
  preds=model.predict(tmp)
  print("Realness:"+str(preds>0.5))

import os

def list_files(directory):
    files = []
    for file in os.listdir(directory):
        if os.path.isfile(os.path.join(directory,file)):
            files.append(file)
    return files
#Example usage:
real_dir = "../input/140k-real-and-fake-faces/real_vs_fake/real-vs-fake/test/real"
fake_dir = "../input/140k-real-and-fake-faces/real_vs_fake/real-vs-fake/test/fake"
real_images = list_files(real_dir)
fake_images = list_files(fake_dir)
print("Real Images :", real_images)
print("Fake Images :", fake_images)

images_to_test = real_images[0:4] #to set range of images to test
dir = real_dir                    #directory used for testing

for imageName in images_to_test:
  filename = dir+"/"+imageName
  img = imagepil.open(filename)
  img = img.resize((224, 224))
  tmp = image.load_img(filename,target_size=(224,224))
  tmp=np.expand_dims(tmp,axis=0)

  print("-----------------------------------------------------------------------------------------------------------------------")
  print("Test Image Path : ",filename)
  display(Image(filename=filename, width= 224, height=224))


  vgg_test(tmp)
  densenet_test(tmp)
  custom_cnn_test(tmp)
  print("\n\n")